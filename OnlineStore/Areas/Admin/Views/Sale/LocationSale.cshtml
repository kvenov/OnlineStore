@{
    ViewData["Title"] = "Sales by Location";
    Layout = "~/Areas/Admin/Views/Shared/_SalesLayout.cshtml";
}

@section Styles{
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
}

<div class="flex gap-4 mb-6">
    <input type="date" id="filterFromDate" class="form-control" />
    <input type="date" id="filterToDate" class="form-control" />
    <input type="text" id="filterCountry" class="form-control" placeholder="Country" />
    <input type="text" id="filterCity" class="form-control" placeholder="City" />
    <input type="text" id="filterZip" class="form-control" placeholder="Zip Code" />
    <button class="btn btn-primary" onclick="loadSalesByLocation()">Apply Filters</button>
</div>

<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <div class="card p-4 shadow">
        <h2 class="text-xl font-semibold mb-3">Sales by Country</h2>
        <canvas id="countrySalesChart"></canvas>
        <table class="table mt-4">
            <thead><tr><th>Country</th><th>Orders</th><th>Total Sales</th></tr></thead>
            <tbody id="countrySalesTable"></tbody>
        </table>
    </div>

    <div class="card p-4 shadow">
        <h2 class="text-xl font-semibold mb-3">Sales by City</h2>
        <canvas id="citySalesChart"></canvas>
        <table class="table mt-4">
            <thead><tr><th>City</th><th>Orders</th><th>Total Sales</th></tr></thead>
            <tbody id="citySalesTable"></tbody>
        </table>
    </div>
</div>

<div class="card p-4 shadow mt-6">
    <div class="flex items-center justify-between mb-3">
        <h2 class="text-xl font-semibold">Sales Heatmap (by City)</h2>
        <small class="text-sm text-gray-500" id="heatmapStatus"></small>
    </div>
    <div id="salesHeatmap" style="width:100%;height:520px;border-radius:.5rem;"></div>
</div>


@section Scripts{
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>
    <script src="~/js/Sale/locationSale.js" asp-append-version="true"></script>
}
